<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#1B9F8E"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-08-28T18:41:49.664284839"><title>Bejeweled | 16 Games in C++</title><script type="application/json" id="virtual-toc-data">[{"id":"o-que-bejeweled","level":0,"title":"O que é Bejeweled?","anchor":"#o-que-bejeweled"},{"id":"o-ciclo-de-jogo-game-loop","level":0,"title":"O Ciclo de Jogo (Game Loop)","anchor":"#o-ciclo-de-jogo-game-loop"},{"id":"a-concep-o-do-jogo-think-hard","level":0,"title":"A Concepção do Jogo: \"Think Hard\"","anchor":"#a-concep-o-do-jogo-think-hard"},{"id":"estrutura-do-c-digo-main-cpp","level":0,"title":"Estrutura do Código (main.cpp)","anchor":"#estrutura-do-c-digo-main-cpp"},{"id":"conceitos-de-programa-o-aprendidos","level":0,"title":"Conceitos de Programação Aprendidos","anchor":"#conceitos-de-programa-o-aprendidos"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/svg" sizes="16x16" href="images/logo.svg"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Bejeweled | 16 Games in C++"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="16 Games in C++ Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/bejeweled.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Bejeweled | 16 Games in C++"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/bejeweled.html#webpage",
    "url": "writerside-documentation/bejeweled.html",
    "name": "Bejeweled | 16 Games in C++",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "16 Games in C++ Help"
}</script><!-- End Schema.org --></head><body data-id="bejeweled" data-main-title="Bejeweled" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="jogos.md|Jogos"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>16 Games in C++  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="bejeweled" id="bejeweled.md">Bejeweled</h1><p id="tmhj7w_3">Este tutorial explora a fundo a cria&ccedil;&atilde;o do jogo Bejeweled, um cl&aacute;ssico &quot;match-3&quot;, utilizando C++ e SFML. Abordaremos desde os conceitos fundamentais do design de jogos at&eacute; a implementa&ccedil;&atilde;o de mec&acirc;nicas complexas e a integra&ccedil;&atilde;o com um sistema de pontua&ccedil;&atilde;o persistente usando SQLite.</p><section class="chapter"><h2 id="o-que-bejeweled" data-toc="o-que-bejeweled">O que &eacute; Bejeweled?</h2><p id="tmhj7w_9">Bejeweled &eacute; um jogo de quebra-cabe&ccedil;a onde o objetivo &eacute; combinar tr&ecirc;s ou mais gemas da mesma cor, seja na horizontal ou na vertical. Ao fazer uma combina&ccedil;&atilde;o, as gemas desaparecem, novas gemas caem para preencher os espa&ccedil;os vazios, e o jogador ganha pontos. O jogo continua at&eacute; que o tempo se esgote ou n&atilde;o haja mais movimentos poss&iacute;veis.</p><section class="chapter"><h3 id="conceitos-fundamentais" data-toc="conceitos-fundamentais">Conceitos Fundamentais:</h3><ul class="list _bullet" id="tmhj7w_11"><li class="list__item" id="tmhj7w_12"><p id="tmhj7w_18"><span class="control" id="tmhj7w_19">Grade de Jogo</span>: Um tabuleiro 8x8 (ou similar) preenchido com gemas.</p></li><li class="list__item" id="tmhj7w_13"><p id="tmhj7w_20"><span class="control" id="tmhj7w_21">Gemas</span>: Pe&ccedil;as coloridas que o jogador manipula.</p></li><li class="list__item" id="tmhj7w_14"><p id="tmhj7w_22"><span class="control" id="tmhj7w_23">Combina&ccedil;&otilde;es (Matches)</span>: Tr&ecirc;s ou mais gemas id&ecirc;nticas alinhadas.</p></li><li class="list__item" id="tmhj7w_15"><p id="tmhj7w_24"><span class="control" id="tmhj7w_25">Troca (Swap)</span>: O jogador troca a posi&ccedil;&atilde;o de duas gemas adjacentes.</p></li><li class="list__item" id="tmhj7w_16"><p id="tmhj7w_26"><span class="control" id="tmhj7w_27">Queda (Gravity)</span>: Gemas acima de espa&ccedil;os vazios caem para preench&ecirc;-los.</p></li><li class="list__item" id="tmhj7w_17"><p id="tmhj7w_28"><span class="control" id="tmhj7w_29">Preenchimento (Refill)</span>: Novas gemas aparecem no topo para completar a grade.</p></li></ul></section></section><section class="chapter"><h2 id="o-ciclo-de-jogo-game-loop" data-toc="o-ciclo-de-jogo-game-loop">O Ciclo de Jogo (Game Loop)</h2><p id="tmhj7w_30">Todo jogo &eacute; constru&iacute;do em torno de um ciclo de execu&ccedil;&atilde;o cont&iacute;nuo, conhecido como &quot;Game Loop&quot;. Este ciclo &eacute; respons&aacute;vel por processar as entradas do jogador, atualizar o estado do jogo e renderizar os gr&aacute;ficos na tela. No Bejeweled, este ciclo &eacute; fundamental para a fluidez das anima&ccedil;&otilde;es e a resposta &agrave;s intera&ccedil;&otilde;es.</p></section><section class="chapter"><h2 id="a-concep-o-do-jogo-think-hard" data-toc="a-concep-o-do-jogo-think-hard">A Concep&ccedil;&atilde;o do Jogo: &quot;Think Hard&quot;</h2><p id="tmhj7w_32">Para construir um jogo como Bejeweled, precisamos pensar em cada etapa, desde a representa&ccedil;&atilde;o dos dados at&eacute; a l&oacute;gica de anima&ccedil;&atilde;o e persist&ecirc;ncia.</p><section class="chapter"><h3 id="1-representa-o-da-grade-e-das-gemas" data-toc="1-representa-o-da-grade-e-das-gemas">1. Representa&ccedil;&atilde;o da Grade e das Gemas</h3><p id="tmhj7w_38">Como vamos armazenar as gemas na grade? Uma matriz 2D &eacute; a escolha natural. Cada elemento da matriz representar&aacute; uma c&eacute;lula da grade, e seu valor indicar&aacute; o tipo (cor) da gema.</p><div class="code-block" data-lang="cpp">
// Estrutura para representar cada peça (gema) na grade
struct piece
{
  int x, y, col, row, kind, match, alpha, special;
  piece(){match=0; alpha=255; special=0;}
} grid[10][10]; // Usamos 10x10 para facilitar bordas e cálculos
</div><p id="tmhj7w_40">A escolha de uma matriz <code class="code" id="tmhj7w_43">grid[10][10]</code> para um tabuleiro de 8x8 n&atilde;o &eacute; arbitr&aacute;ria. As linhas e colunas extras (&iacute;ndices 0 e 9) servem como &quot;bordas sentinela&quot; ou &quot;padding&quot;. Isso simplifica significativamente a l&oacute;gica de verifica&ccedil;&atilde;o de vizinhos e limites, evitando a necessidade de m&uacute;ltiplas verifica&ccedil;&otilde;es <code class="code" id="tmhj7w_44">if</code> para os cantos e bordas do tabuleiro real (&iacute;ndices 1 a 8).</p><p id="tmhj7w_41">Cada campo da <code class="code" id="tmhj7w_45">struct piece</code> tem um prop&oacute;sito crucial:</p><ul class="list _bullet" id="tmhj7w_42"><li class="list__item" id="tmhj7w_46"><p id="tmhj7w_52"><code class="code" id="tmhj7w_53">x</code>, <code class="code" id="tmhj7w_54">y</code>: Coordenadas em pixels na tela. Estas s&atilde;o as posi&ccedil;&otilde;es visuais da gema. Elas s&atilde;o atualizadas durante as anima&ccedil;&otilde;es de queda e troca.</p></li><li class="list__item" id="tmhj7w_47"><p id="tmhj7w_55"><code class="code" id="tmhj7w_56">col</code>, <code class="code" id="tmhj7w_57">row</code>: Coordenadas l&oacute;gicas da gema na matriz <code class="code" id="tmhj7w_58">grid</code>. <code class="code" id="tmhj7w_59">col</code> refere-se &agrave; coluna e <code class="code" id="tmhj7w_60">row</code> &agrave; linha. Estas s&atilde;o as posi&ccedil;&otilde;es &quot;reais&quot; da gema no tabuleiro l&oacute;gico do jogo.</p></li><li class="list__item" id="tmhj7w_48"><p id="tmhj7w_61"><code class="code" id="tmhj7w_62">kind</code>: O tipo da gema, geralmente representando sua cor ou design. Um valor inteiro (0-6) &eacute; eficiente para mapear a texturas ou cores.</p></li><li class="list__item" id="tmhj7w_49"><p id="tmhj7w_63"><code class="code" id="tmhj7w_64">match</code>: Uma flag booleana (0 ou 1) que indica se esta gema faz parte de uma combina&ccedil;&atilde;o detectada. Gemas marcadas com <code class="code" id="tmhj7w_65">match = 1</code> ser&atilde;o removidas.</p></li><li class="list__item" id="tmhj7w_50"><p id="tmhj7w_66"><code class="code" id="tmhj7w_67">alpha</code>: O canal alfa (transpar&ecirc;ncia) da gema. Usado para criar efeitos de desaparecimento suaves. Um valor de 255 significa totalmente opaco, 0 significa totalmente transparente.</p></li><li class="list__item" id="tmhj7w_51"><p id="tmhj7w_68"><code class="code" id="tmhj7w_69">special</code>: Uma flag para indicar se a gema &eacute; um tipo especial (ex: uma bomba que explode gemas adjacentes, uma gema que limpa uma linha/coluna). Isso permite a cria&ccedil;&atilde;o de mec&acirc;nicas mais avan&ccedil;adas.</p></li></ul></section><section class="chapter"><h3 id="2-mec-nicas-principais" data-toc="2-mec-nicas-principais">2. Mec&acirc;nicas Principais</h3><p id="tmhj7w_70">As mec&acirc;nicas de um jogo &quot;match-3&quot; operam em um ciclo cont&iacute;nuo: jogador interage -&gt; jogo processa -&gt; jogo reage -&gt; jogo se prepara para pr&oacute;xima intera&ccedil;&atilde;o.</p><section class="chapter"><h4 id="a-troca-de-gemas-swap" data-toc="a-troca-de-gemas-swap">a) Troca de Gemas (Swap)</h4><p id="tmhj7w_76">A troca &eacute; a intera&ccedil;&atilde;o fundamental do jogador. Quando duas gemas s&atilde;o clicadas, suas posi&ccedil;&otilde;es na grade s&atilde;o trocadas.</p><div class="code-block" data-lang="cpp">
void swap(piece p1,piece p2)
{
  std::swap(p1.col,p2.col);
  std::swap(p1.row,p2.row);

  grid[p1.row][p1.col]=p1;
  grid[p2.row][p2.col]=p2;
}
</div><p id="tmhj7w_78"><span class="control" id="tmhj7w_82">An&aacute;lise Detalhada da Troca:</span></p><ol class="list _decimal" id="tmhj7w_79" type="1"><li class="list__item" id="tmhj7w_83"><p id="tmhj7w_88"><span class="control" id="tmhj7w_89">Identifica&ccedil;&atilde;o da Troca</span>: O jogador clica em uma gema (<code class="code" id="tmhj7w_90">click=1</code>), e depois em uma segunda gema adjacente (<code class="code" id="tmhj7w_91">click=2</code>). As coordenadas dessas gemas s&atilde;o capturadas.</p></li><li class="list__item" id="tmhj7w_84"><p id="tmhj7w_92"><span class="control" id="tmhj7w_93">Valida&ccedil;&atilde;o da Adjac&ecirc;ncia</span>: Antes de qualquer troca, o jogo verifica se as duas gemas selecionadas s&atilde;o adjacentes (horizontal ou verticalmente). Se n&atilde;o forem, a segunda gema clicada se torna a primeira, e o processo recome&ccedil;a (<code class="code" id="tmhj7w_94">click=1</code>).</p></li><li class="list__item" id="tmhj7w_85"><p id="tmhj7w_95"><span class="control" id="tmhj7w_97">Troca L&oacute;gica</span>: A fun&ccedil;&atilde;o <code class="code" id="tmhj7w_98">swap</code> &eacute; chamada. &Eacute; importante notar que a fun&ccedil;&atilde;o <code class="code" id="tmhj7w_99">std::swap</code> dentro de <code class="code" id="tmhj7w_100">swap(piece p1, piece p2)</code> est&aacute; trocando os <span class="emphasis" id="tmhj7w_101">valores</span> das c&oacute;pias <code class="code" id="tmhj7w_102">p1</code> e <code class="code" id="tmhj7w_103">p2</code>, n&atilde;o as gemas diretamente na <code class="code" id="tmhj7w_104">grid</code>. O c&oacute;digo fornecido &eacute; uma simplifica&ccedil;&atilde;o. Na implementa&ccedil;&atilde;o real, voc&ecirc; precisaria trocar os elementos da matriz <code class="code" id="tmhj7w_105">grid</code> diretamente, ou passar <code class="code" id="tmhj7w_106">p1</code> e <code class="code" id="tmhj7w_107">p2</code> por refer&ecirc;ncia, ou, mais comumente, trocar os <code class="code" id="tmhj7w_108">kind</code> (tipo/cor) das gemas nas posi&ccedil;&otilde;es <code class="code" id="tmhj7w_109">(y0, x0)</code> e <code class="code" id="tmhj7w_110">(y, x)</code> e ent&atilde;o atualizar suas coordenadas <code class="code" id="tmhj7w_111">col</code> e <code class="code" id="tmhj7w_112">row</code> para refletir a nova posi&ccedil;&atilde;o.</p><div class="code-block" data-lang="cpp">
// Exemplo de como a troca real deveria ser implementada no contexto do jogo
// Assumindo que (y0, x0) e (y, x) são as coordenadas das gemas clicadas
piece temp = grid[y0][x0];
grid[y0][x0] = grid[y][x];
grid[y][x] = temp;

// Atualizar as propriedades col/row das peças que foram movidas
grid[y0][x0].col = x0; grid[y0][x0].row = y0;
grid[y][x].col = x; grid[y][x].row = y;
</div></li><li class="list__item" id="tmhj7w_86"><p id="tmhj7w_113"><span class="control" id="tmhj7w_114">Verifica&ccedil;&atilde;o P&oacute;s-Troca</span>: Ap&oacute;s a troca l&oacute;gica, o jogo imediatamente verifica se essa troca resultou em <span class="emphasis" id="tmhj7w_115">qualquer</span> combina&ccedil;&atilde;o.</p></li><li class="list__item" id="tmhj7w_87"><p id="tmhj7w_116"><span class="control" id="tmhj7w_117">Desfazer a Troca (se necess&aacute;rio)</span>: Se a troca n&atilde;o gerar nenhuma combina&ccedil;&atilde;o v&aacute;lida, ela deve ser desfeita. Isso &eacute; crucial para a jogabilidade do Bejeweled, onde apenas trocas que resultam em matches s&atilde;o permitidas. O estado <code class="code" id="tmhj7w_118">isSwap</code> e a verifica&ccedil;&atilde;o <code class="code" id="tmhj7w_119">!hasMatches</code> no loop principal s&atilde;o usados para isso: <code class="code" id="tmhj7w_120">if (isSwap &amp;&amp; !isMoving) { if (!hasMatches) swap(grid[y0][x0],grid[y][x]); else score += currentMatchScore * 10; isSwap=0; }</code>.</p></li></ol><p id="tmhj7w_80"><span class="control" id="tmhj7w_121">Fluxo da Troca de Gemas (Tentar e Desfazer):</span></p></section><section class="chapter"><h4 id="b-detec-o-de-combina-es-match-finding" data-toc="b-detec-o-de-combina-es-match-finding">b) Detec&ccedil;&atilde;o de Combina&ccedil;&otilde;es (Match Finding)</h4><p id="tmhj7w_122">Ap&oacute;s cada troca, o jogo deve varrer a grade para encontrar combina&ccedil;&otilde;es de 3 ou mais gemas.</p><div class="code-block" data-lang="cpp">
// Simplificação da lógica de detecção de combinações
bool hasMatches = false;
for(int i=1;i&lt;=8;i++) { // Iterar sobre a grade (ignorar bordas)
    for(int j=1;j&lt;=8;j++) {
        // Verificar combinações horizontais
        if (j&lt;=6 &amp;&amp; grid[i][j].kind==grid[i][j+1].kind &amp;&amp; grid[i][j].kind==grid[i][j+2].kind) {
            for(int k=0;k&lt;3;k++) grid[i][j+k].match = 1; // Marcar como combinada
            hasMatches = true;
        }
        // Verificar combinações verticais
        if (i&lt;=6 &amp;&amp; grid[i][j].kind==grid[i+1][j].kind &amp;&amp; grid[i][j].kind==grid[i+2][j].kind) {
            for(int k=0;k&lt;3;k++) grid[i+k][j].match = 1; // Marcar como combinada
            hasMatches = true;
        }
    }
}
</div><p id="tmhj7w_124"><span class="control" id="tmhj7w_128">An&aacute;lise Detalhada da Detec&ccedil;&atilde;o de Combina&ccedil;&otilde;es:</span></p><ol class="list _decimal" id="tmhj7w_125" type="1"><li class="list__item" id="tmhj7w_129"><p id="tmhj7w_134"><span class="control" id="tmhj7w_135">Varredura Exaustiva</span>: O algoritmo percorre cada c&eacute;lula do tabuleiro (ignorando as bordas sentinela, da&iacute; <code class="code" id="tmhj7w_136">i=1</code> a <code class="code" id="tmhj7w_137">8</code> e <code class="code" id="tmhj7w_138">j=1</code> a <code class="code" id="tmhj7w_139">8</code>). Para cada c&eacute;lula, ele verifica se h&aacute; uma combina&ccedil;&atilde;o de 3 ou mais gemas id&ecirc;nticas come&ccedil;ando naquela posi&ccedil;&atilde;o, tanto na horizontal quanto na vertical.</p></li><li class="list__item" id="tmhj7w_130"><p id="tmhj7w_140"><span class="control" id="tmhj7w_142">Condi&ccedil;&otilde;es de Verifica&ccedil;&atilde;o</span>:</p><ul class="list _bullet" id="tmhj7w_141"><li class="list__item" id="tmhj7w_143"><p id="tmhj7w_146"><code class="code" id="tmhj7w_147">j&lt;=6</code>: Garante que h&aacute; pelo menos duas c&eacute;lulas &agrave; direita para verificar uma combina&ccedil;&atilde;o horizontal de 3.</p></li><li class="list__item" id="tmhj7w_144"><p id="tmhj7w_148"><code class="code" id="tmhj7w_149">i&lt;=6</code>: Garante que h&aacute; pelo menos duas c&eacute;lulas abaixo para verificar uma combina&ccedil;&atilde;o vertical de 3.</p></li><li class="list__item" id="tmhj7w_145"><p id="tmhj7w_150"><code class="code" id="tmhj7w_151">grid[i][j].kind==grid[i][j+1].kind &amp;&amp; grid[i][j].kind==grid[i][j+2].kind</code>: Compara os tipos (cores) das gemas.</p></li></ul></li><li class="list__item" id="tmhj7w_131"><p id="tmhj7w_152"><span class="control" id="tmhj7w_153">Marca&ccedil;&atilde;o de Combina&ccedil;&otilde;es</span>: Se uma combina&ccedil;&atilde;o &eacute; encontrada, as gemas envolvidas s&atilde;o marcadas com <code class="code" id="tmhj7w_154">grid[...].match = 1</code>. Esta marca&ccedil;&atilde;o &eacute; crucial para as fases subsequentes de desaparecimento e queda.</p></li><li class="list__item" id="tmhj7w_132"><p id="tmhj7w_155"><span class="control" id="tmhj7w_156">Complexidade</span>: A complexidade deste algoritmo &eacute; O(N<span class="emphasis" id="tmhj7w_157">M), onde N &eacute; o n&uacute;mero de linhas e M &eacute; o n&uacute;mero de colunas. Para um tabuleiro 8x8, isso &eacute; 8</span>8 = 64 verifica&ccedil;&otilde;es por tipo de combina&ccedil;&atilde;o (horizontal/vertical), o que &eacute; extremamente r&aacute;pido.</p></li><li class="list__item" id="tmhj7w_133"><p id="tmhj7w_158"><span class="control" id="tmhj7w_160">Gemas Especiais (Think Ultra Hard)</span>:</p><ul class="list _bullet" id="tmhj7w_159"><li class="list__item" id="tmhj7w_161"><p id="tmhj7w_164"><span class="control" id="tmhj7w_165">Cria&ccedil;&atilde;o</span>: Se uma combina&ccedil;&atilde;o de 4 gemas &eacute; feita, a gema que foi trocada para formar a combina&ccedil;&atilde;o (ou uma gema central) pode se tornar uma gema especial (ex: <code class="code" id="tmhj7w_166">grid[y][x].special = 1</code>). O c&oacute;digo j&aacute; tem a flag <code class="code" id="tmhj7w_167">special</code>.</p></li><li class="list__item" id="tmhj7w_162"><p id="tmhj7w_168"><span class="control" id="tmhj7w_169">Ativa&ccedil;&atilde;o</span>: Quando uma gema especial marcada com <code class="code" id="tmhj7w_170">match = 1</code> &eacute; processada, ela pode ativar um efeito secund&aacute;rio. Por exemplo, uma gema &quot;bomba&quot; pode marcar todas as gemas adjacentes (3x3) com <code class="code" id="tmhj7w_171">match = 1</code>, criando uma rea&ccedil;&atilde;o em cadeia. O c&oacute;digo j&aacute; tem uma l&oacute;gica de &quot;Bomb activation&quot; que faz isso.</p></li><li class="list__item" id="tmhj7w_163"><p id="tmhj7w_172"><span class="control" id="tmhj7w_173">Rea&ccedil;&otilde;es em Cadeia</span>: A detec&ccedil;&atilde;o de combina&ccedil;&otilde;es e a ativa&ccedil;&atilde;o de gemas especiais podem ser iterativas. Ap&oacute;s uma rodada de matches e ativa&ccedil;&otilde;es, o jogo pode precisar re-verificar por novas combina&ccedil;&otilde;es criadas pelas explos&otilde;es, at&eacute; que n&atilde;o haja mais matches.</p></li></ul></li></ol><p id="tmhj7w_126"><span class="control" id="tmhj7w_174">Visualiza&ccedil;&atilde;o da Detec&ccedil;&atilde;o de Combina&ccedil;&otilde;es:</span> Imagine o tabuleiro. O algoritmo varre cada c&eacute;lula e &quot;olha&quot; para a direita e para baixo para encontrar 3 gemas iguais.</p><div class="code-block" data-lang="none">
[G1] [G1] [G1] [G2] ...  (Horizontal Match)
[G3]
[G3]
[G3]
[G4]
...                      (Vertical Match)
</div></section><section class="chapter"><h4 id="c-anima-o-de-desaparecimento-e-pontua-o" data-toc="c-anima-o-de-desaparecimento-e-pontua-o">c) Anima&ccedil;&atilde;o de Desaparecimento e Pontua&ccedil;&atilde;o</h4><p id="tmhj7w_175">Gemas combinadas n&atilde;o desaparecem instantaneamente. Elas diminuem a transpar&ecirc;ncia (<code class="code" id="tmhj7w_179">alpha</code>) para criar um efeito visual suave. Durante essa fase, a pontua&ccedil;&atilde;o &eacute; atualizada.</p><div class="code-block" data-lang="cpp">
// Lógica de animação de desaparecimento
if (!isMoving) // Se não houver gemas caindo
    for (int i=1;i&lt;=8;i++)
        for (int j=1;j&lt;=8;j++)
            if (grid[i][j].match) // Se a gema faz parte de uma combinação
                if (grid[i][j].alpha&gt;10) {grid[i][j].alpha-=10; isMoving=true;} // Diminuir alpha
</div><p id="tmhj7w_177"><span class="control" id="tmhj7w_180">An&aacute;lise Detalhada da Anima&ccedil;&atilde;o de Desaparecimento:</span></p><ol class="list _decimal" id="tmhj7w_178" type="1"><li class="list__item" id="tmhj7w_181"><p id="tmhj7w_185"><span class="control" id="tmhj7w_186">Controle de Fluxo (<code class="code" id="tmhj7w_188">isMoving</code>)</span>: A anima&ccedil;&atilde;o de desaparecimento s&oacute; ocorre se <code class="code" id="tmhj7w_187">!isMoving</code> for verdadeiro. Isso garante que as gemas n&atilde;o desapare&ccedil;am enquanto outras gemas ainda est&atilde;o caindo ou se movendo.</p></li><li class="list__item" id="tmhj7w_182"><p id="tmhj7w_189"><span class="control" id="tmhj7w_190">Diminui&ccedil;&atilde;o Gradual do <code class="code" id="tmhj7w_194">alpha</code></span>: Para cada gema marcada com <code class="code" id="tmhj7w_191">match = 1</code>, seu valor <code class="code" id="tmhj7w_192">alpha</code> &eacute; gradualmente reduzido (ex: <code class="code" id="tmhj7w_193">alpha-=10</code>). Isso cria um efeito de &quot;fade out&quot;.</p></li><li class="list__item" id="tmhj7w_183"><p id="tmhj7w_195"><span class="control" id="tmhj7w_196">Sinaliza&ccedil;&atilde;o de Anima&ccedil;&atilde;o</span>: Se qualquer gema estiver em processo de desaparecimento (<code class="code" id="tmhj7w_197">alpha &gt; 10</code>), a flag <code class="code" id="tmhj7w_198">isMoving</code> &eacute; definida como <code class="code" id="tmhj7w_199">true</code>. Isso impede que outras fases do jogo (como a queda de gemas) comecem antes que a anima&ccedil;&atilde;o atual termine.</p></li><li class="list__item" id="tmhj7w_184"><p id="tmhj7w_200"><span class="control" id="tmhj7w_201">Pontua&ccedil;&atilde;o</span>: A pontua&ccedil;&atilde;o &eacute; geralmente calculada e adicionada ao <code class="code" id="tmhj7w_202">score</code> quando as gemas s&atilde;o marcadas como <code class="code" id="tmhj7w_203">match = 1</code>, ou quando a anima&ccedil;&atilde;o de desaparecimento est&aacute; completa. O c&oacute;digo mostra <code class="code" id="tmhj7w_204">score += currentMatchScore * 10;</code> ap&oacute;s a verifica&ccedil;&atilde;o de matches, o que &eacute; um bom ponto para adicionar a pontua&ccedil;&atilde;o.</p></li></ol></section><section class="chapter"><h4 id="d-queda-de-gemas-gravity" data-toc="d-queda-de-gemas-gravity">d) Queda de Gemas (Gravity)</h4><p id="tmhj7w_205">Ap&oacute;s as gemas combinadas desaparecerem, as gemas acima delas devem cair para preencher os espa&ccedil;os vazios.</p><div class="code-block" data-lang="cpp">
// Atualização da grade após combinações
if (!isMoving) // Se não houver animações de movimento
{
    // Mover gemas para baixo para preencher espaços vazios
    for(int i=8;i&gt;0;i--) // De baixo para cima
        for(int j=1;j&lt;=8;j++) // Da esquerda para a direita
            if (grid[i][j].match) // Se a gema foi combinada (espaço vazio)
                for(int n=i;n&gt;0;n--) // Procurar gema acima
                    if (!grid[n][j].match) {swap(grid[n][j],grid[i][j]); break;}; // Trocar com a gema acima
    // ... (lógica para preencher o topo com novas gemas)
}
</div><p id="tmhj7w_207"><span class="control" id="tmhj7w_211">An&aacute;lise Detalhada da Queda de Gemas:</span></p><ol class="list _decimal" id="tmhj7w_208" type="1"><li class="list__item" id="tmhj7w_212"><p id="tmhj7w_217"><span class="control" id="tmhj7w_218">Itera&ccedil;&atilde;o de Baixo para Cima</span>: O loop externo (<code class="code" id="tmhj7w_219">for(int i=8;i&gt;0;i--)</code>) itera as linhas de baixo para cima. Isso &eacute; crucial. Se iter&aacute;ssemos de cima para baixo, uma gema poderia cair em um espa&ccedil;o vazio, mas o espa&ccedil;o vazio abaixo dela n&atilde;o seria preenchido na mesma itera&ccedil;&atilde;o.</p></li><li class="list__item" id="tmhj7w_213"><p id="tmhj7w_220"><span class="control" id="tmhj7w_221">Identifica&ccedil;&atilde;o de Espa&ccedil;os Vazios</span>: Uma c&eacute;lula &eacute; considerada &quot;vazia&quot; se sua gema foi marcada com <code class="code" id="tmhj7w_222">match = 1</code> (e j&aacute; desapareceu).</p></li><li class="list__item" id="tmhj7w_214"><p id="tmhj7w_223"><span class="control" id="tmhj7w_224">Busca por Gema Acima</span>: Para cada espa&ccedil;o vazio, o loop interno (<code class="code" id="tmhj7w_225">for(int n=i;n&gt;0;n--)</code>) procura a primeira gema <span class="emphasis" id="tmhj7w_226">n&atilde;o combinada</span> (<code class="code" id="tmhj7w_227">!grid[n][j].match</code>) diretamente acima na mesma coluna.</p></li><li class="list__item" id="tmhj7w_215"><p id="tmhj7w_228"><span class="control" id="tmhj7w_229">Troca e Deslocamento</span>: Uma vez encontrada uma gema acima, ela &eacute; trocada com o espa&ccedil;o vazio. Isso efetivamente faz a gema &quot;cair&quot;. O <code class="code" id="tmhj7w_230">break</code> &eacute; importante para que apenas a primeira gema acima caia para aquele espa&ccedil;o.</p></li><li class="list__item" id="tmhj7w_216"><p id="tmhj7w_231"><span class="control" id="tmhj7w_232">Anima&ccedil;&atilde;o de Queda (Think Ultra Hard)</span>: A troca l&oacute;gica (<code class="code" id="tmhj7w_233">swap</code>) apenas atualiza as posi&ccedil;&otilde;es na matriz. Para uma anima&ccedil;&atilde;o suave, as coordenadas <code class="code" id="tmhj7w_234">x</code> e <code class="code" id="tmhj7w_235">y</code> em pixels das gemas precisam ser atualizadas gradualmente ao longo do tempo. A flag <code class="code" id="tmhj7w_236">isMoving</code> seria definida como <code class="code" id="tmhj7w_237">true</code> durante essa anima&ccedil;&atilde;o, e as gemas se moveriam pixel a pixel at&eacute; suas novas posi&ccedil;&otilde;es <code class="code" id="tmhj7w_238">(row*ts, col*ts)</code>.</p></li></ol><p id="tmhj7w_209"><span class="control" id="tmhj7w_239">Visualiza&ccedil;&atilde;o da Queda de Gemas:</span> Imagine uma coluna de gemas. O algoritmo encontra um espa&ccedil;o vazio (X) e move a gema acima (G) para baixo.</p><div class="code-block" data-lang="none">
[G]   [ ]
[ ]   [G]
[X]   [X]
[B]   [B]
</div></section><section class="chapter"><h4 id="e-preenchimento-da-grade-refill" data-toc="e-preenchimento-da-grade-refill">e) Preenchimento da Grade (Refill)</h4><p id="tmhj7w_240">Finalmente, os espa&ccedil;os vazios no topo da grade s&atilde;o preenchidos com novas gemas geradas aleatoriamente.</p><div class="code-block" data-lang="cpp">
// Preencher o topo com novas gemas
for(int j=1;j&lt;=8;j++) // Para cada coluna
    for(int i=8,n=0;i&gt;0;i--) // De baixo para cima
        if (grid[i][j].match) // Se a gema foi combinada (espaço vazio)
        {
            grid[i][j].kind = rand()%7; // Nova gema aleatória
            grid[i][j].y = -ts*n++; // Posição inicial acima da tela para animação de queda
            grid[i][j].match=0; // Resetar flag de combinação
            grid[i][j].alpha = 255; // Resetar transparência
            grid[i][j].special = 0; // Resetar flag de especial
        }
</div><p id="tmhj7w_242"><span class="control" id="tmhj7w_246">An&aacute;lise Detalhada do Preenchimento da Grade:</span></p><ol class="list _decimal" id="tmhj7w_243" type="1"><li class="list__item" id="tmhj7w_247"><p id="tmhj7w_252"><span class="control" id="tmhj7w_253">Identifica&ccedil;&atilde;o de Espa&ccedil;os Vazios Remanescentes</span>: Ap&oacute;s a queda das gemas existentes, ainda pode haver espa&ccedil;os vazios no topo da grade (onde as gemas ca&iacute;ram de fora da tela ou onde as gemas originais foram removidas). Estes s&atilde;o identificados novamente pela flag <code class="code" id="tmhj7w_254">match = 1</code>.</p></li><li class="list__item" id="tmhj7w_248"><p id="tmhj7w_255"><span class="control" id="tmhj7w_256">Gera&ccedil;&atilde;o Aleat&oacute;ria</span>: Para cada um desses espa&ccedil;os, uma nova gema &eacute; gerada com um <code class="code" id="tmhj7w_257">kind</code> aleat&oacute;rio (<code class="code" id="tmhj7w_258">rand()%7</code>).</p></li><li class="list__item" id="tmhj7w_249"><p id="tmhj7w_259"><span class="control" id="tmhj7w_261">Posicionamento para Anima&ccedil;&atilde;o de &quot;Chuva&quot;</span>: A linha <code class="code" id="tmhj7w_262">grid[i][j].y = -ts*n++;</code> &eacute; a chave para a anima&ccedil;&atilde;o de &quot;chuva&quot;.</p><ul class="list _bullet" id="tmhj7w_260"><li class="list__item" id="tmhj7w_263"><p id="tmhj7w_265"><code class="code" id="tmhj7w_266">ts</code>: Tamanho do tile (gema) em pixels.</p></li><li class="list__item" id="tmhj7w_264"><p id="tmhj7w_267"><code class="code" id="tmhj7w_268">n++</code>: Um contador que garante que cada nova gema na mesma coluna comece progressivamente mais acima da tela. Por exemplo, a primeira gema a ser preenchida no topo de uma coluna pode ter <code class="code" id="tmhj7w_269">y = -ts</code>, a pr&oacute;xima <code class="code" id="tmhj7w_270">y = -2*ts</code>, e assim por diante. Isso cria um efeito visual de que as gemas est&atilde;o caindo de fora da tela.</p></li></ul></li><li class="list__item" id="tmhj7w_250"><p id="tmhj7w_271"><span class="control" id="tmhj7w_272">Reset de Flags</span>: As flags <code class="code" id="tmhj7w_273">match</code>, <code class="code" id="tmhj7w_274">alpha</code> e <code class="code" id="tmhj7w_275">special</code> s&atilde;o resetadas para as novas gemas, preparando-as para futuras intera&ccedil;&otilde;es.</p></li><li class="list__item" id="tmhj7w_251"><p id="tmhj7w_276"><span class="control" id="tmhj7w_277">Ciclo Cont&iacute;nuo</span>: Ap&oacute;s o preenchimento, o jogo pode precisar re-verificar por novas combina&ccedil;&otilde;es, pois as gemas rec&eacute;m-ca&iacute;das podem ter formado novos matches. Este ciclo de &quot;detec&ccedil;&atilde;o -&gt; desaparecimento -&gt; queda -&gt; preenchimento -&gt; re-detec&ccedil;&atilde;o&quot; continua at&eacute; que n&atilde;o haja mais combina&ccedil;&otilde;es.</p></li></ol><p id="tmhj7w_244"><span class="control" id="tmhj7w_278">Visualiza&ccedil;&atilde;o da Anima&ccedil;&atilde;o de &quot;Chuva&quot;:</span> Imagine novas gemas (N) aparecendo acima da tela e caindo para preencher os espa&ccedil;os vazios (X).</p><div class="code-block" data-lang="none">
[N]
[N]
[X]
[X]
[G]
</div></section></section><section class="chapter"><h3 id="3-sistema-de-pontua-o-e-tempo" data-toc="3-sistema-de-pontua-o-e-tempo">3. Sistema de Pontua&ccedil;&atilde;o e Tempo</h3><p id="tmhj7w_279">O jogo tem um cron&ocirc;metro regressivo (<code class="code" id="tmhj7w_283">gameTimer</code>) e uma pontua&ccedil;&atilde;o (<code class="code" id="tmhj7w_284">score</code>).</p><div class="code-block" data-lang="cpp">
float gameTimer; // Tempo restante de jogo
int score = 0;   // Pontuação atual
</div><p id="tmhj7w_281"><span class="control" id="tmhj7w_285">An&aacute;lise Detalhada do Sistema de Pontua&ccedil;&atilde;o e Tempo:</span></p><ol class="list _decimal" id="tmhj7w_282" type="1"><li class="list__item" id="tmhj7w_286"><p id="tmhj7w_289"><span class="control" id="tmhj7w_290"><code class="code" id="tmhj7w_293">gameTimer</code></span>: Inicializado com um valor (ex: 60 segundos). A cada frame, o <code class="code" id="tmhj7w_291">deltaTime</code> (tempo decorrido desde o &uacute;ltimo frame) &eacute; subtra&iacute;do de <code class="code" id="tmhj7w_292">gameTimer</code>.</p></li><li class="list__item" id="tmhj7w_287"><p id="tmhj7w_294"><span class="control" id="tmhj7w_295">Game Over</span>: Quando <code class="code" id="tmhj7w_296">gameTimer</code> atinge ou passa de zero, o <code class="code" id="tmhj7w_297">gameState</code> muda para <code class="code" id="tmhj7w_298">GameOver</code>. Neste ponto, a pontua&ccedil;&atilde;o final do jogador &eacute; salva no sistema de persist&ecirc;ncia.</p></li><li class="list__item" id="tmhj7w_288"><p id="tmhj7w_299"><span class="control" id="tmhj7w_300"><code class="code" id="tmhj7w_301">score</code></span>: Incrementado com base no n&uacute;mero de gemas combinadas. Combina&ccedil;&otilde;es maiores ou rea&ccedil;&otilde;es em cadeia podem conceder b&ocirc;nus de pontua&ccedil;&atilde;o.</p></li></ol></section><section class="chapter"><h3 id="4-estados-do-jogo-game-state-management" data-toc="4-estados-do-jogo-game-state-management">4. Estados do Jogo (Game State Management)</h3><p id="tmhj7w_302">Para gerenciar as diferentes telas (menu, jogo, game over, high scores), usamos um <code class="code" id="tmhj7w_308">enum</code>.</p><div class="code-block" data-lang="cpp">
enum GameState { MainMenu, Playing, GameOver, HighScores };
GameState gameState = MainMenu;
</div><p id="tmhj7w_304"><span class="control" id="tmhj7w_309">An&aacute;lise Detalhada dos Estados do Jogo:</span></p><ol class="list _decimal" id="tmhj7w_305" type="1"><li class="list__item" id="tmhj7w_310"><p id="tmhj7w_313"><span class="control" id="tmhj7w_314">M&aacute;quina de Estados Finitos (FSM)</span>: A utiliza&ccedil;&atilde;o de um <code class="code" id="tmhj7w_315">enum GameState</code> &eacute; uma implementa&ccedil;&atilde;o simples de uma FSM. Isso &eacute; um padr&atilde;o de design crucial em jogos para organizar o fluxo do programa.</p></li><li class="list__item" id="tmhj7w_311"><p id="tmhj7w_316"><span class="control" id="tmhj7w_318">Transi&ccedil;&otilde;es</span>: As transi&ccedil;&otilde;es entre os estados s&atilde;o controladas por eventos do usu&aacute;rio (cliques em bot&otilde;es do menu) ou por condi&ccedil;&otilde;es do jogo (cron&ocirc;metro zerado).</p><ul class="list _bullet" id="tmhj7w_317"><li class="list__item" id="tmhj7w_319"><p id="tmhj7w_323"><code class="code" id="tmhj7w_324">MainMenu</code>: Exibe op&ccedil;&otilde;es como &quot;Jogar&quot;, &quot;Melhores Pontua&ccedil;&otilde;es&quot;, &quot;Sair&quot;. Um clique em &quot;Jogar&quot; muda para <code class="code" id="tmhj7w_325">Playing</code>.</p></li><li class="list__item" id="tmhj7w_320"><p id="tmhj7w_326"><code class="code" id="tmhj7w_327">Playing</code>: O estado ativo do jogo. Toda a l&oacute;gica de mec&acirc;nicas (troca, matches, queda, etc.) &eacute; executada apenas neste estado.</p></li><li class="list__item" id="tmhj7w_321"><p id="tmhj7w_328"><code class="code" id="tmhj7w_329">GameOver</code>: Exibido quando o jogo termina. Mostra a pontua&ccedil;&atilde;o final e op&ccedil;&otilde;es como &quot;Jogar Novamente&quot; (volta para <code class="code" id="tmhj7w_330">Playing</code> ap&oacute;s reset) ou &quot;Voltar ao Menu&quot; (volta para <code class="code" id="tmhj7w_331">MainMenu</code>).</p></li><li class="list__item" id="tmhj7w_322"><p id="tmhj7w_332"><code class="code" id="tmhj7w_333">HighScores</code>: Exibe a lista das melhores pontua&ccedil;&otilde;es carregadas do banco de dados. Um bot&atilde;o &quot;Voltar ao Menu&quot; permite retornar.</p></li></ul></li><li class="list__item" id="tmhj7w_312"><p id="tmhj7w_334"><span class="control" id="tmhj7w_336">Benef&iacute;cios da FSM</span>:</p><ul class="list _bullet" id="tmhj7w_335"><li class="list__item" id="tmhj7w_337"><p id="tmhj7w_340"><span class="control" id="tmhj7w_341">Organiza&ccedil;&atilde;o</span>: O c&oacute;digo fica mais limpo, pois a l&oacute;gica de cada estado &eacute; encapsulada.</p></li><li class="list__item" id="tmhj7w_338"><p id="tmhj7w_342"><span class="control" id="tmhj7w_343">Controle</span>: Evita que l&oacute;gicas de diferentes telas se misturem ou executem em momentos inadequados.</p></li><li class="list__item" id="tmhj7w_339"><p id="tmhj7w_344"><span class="control" id="tmhj7w_345">Manuten&ccedil;&atilde;o</span>: Facilita a adi&ccedil;&atilde;o de novos estados ou a modifica&ccedil;&atilde;o de estados existentes.</p></li></ul></li></ol><p id="tmhj7w_306"><span class="control" id="tmhj7w_346">Diagrama da M&aacute;quina de Estados:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1140.546875 496.1719970703125" height="496.1719970703125" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1140.546875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M85.878,321.563L99.549,286.154C113.221,250.746,140.564,179.93,156.36,144.563C172.156,109.197,176.406,109.28,179.99,109.35C183.573,109.42,186.49,109.478,187.949,109.506L189.407,109.535"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M287.563,109.613L291.646,109.53C295.729,109.447,303.896,109.28,310.063,109.197C316.229,109.113,320.396,109.113,323.896,109.113C327.396,109.113,330.229,109.113,331.646,109.113L333.063,109.113"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M449.719,96.552L453.885,95.623C458.052,94.693,466.385,92.835,474.48,91.947C482.574,91.06,490.43,91.143,497.619,91.219C504.807,91.296,511.33,91.365,514.591,91.4L517.852,91.434"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M687.805,91.477L695.493,91.393C703.182,91.31,718.56,91.143,728.52,91.06C738.48,90.977,743.023,90.977,746.9,90.977C750.776,90.977,753.986,90.977,755.59,90.977L757.195,90.977"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M899.633,90.977L904.176,90.977C908.719,90.977,917.805,90.977,925.496,91.507C933.186,92.037,939.482,93.097,945.121,94.047C950.759,94.996,955.74,95.835,958.23,96.255L960.721,96.674"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_C_5" d="M994.304,151.526L983.068,161.097C971.833,170.669,949.362,189.811,922.047,199.382C894.732,208.953,862.573,208.953,830.414,208.953C798.255,208.953,766.096,208.953,728.415,208.953C690.734,208.953,647.531,208.953,604.328,208.953C561.125,208.953,517.922,208.953,491.376,202.883C464.83,196.813,454.941,184.673,445.473,173.05C436.005,161.427,426.958,150.321,422.434,144.768L417.911,139.215"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_G_6" d="M844.286,117.977L858.053,144.773C871.821,171.57,899.356,225.164,918.571,255.275C937.787,285.386,948.684,292.014,959.011,298.296C969.338,304.578,979.095,310.513,983.974,313.481L988.852,316.448"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_A_7" d="M1006.083,393.411L992.884,409.205C979.686,424.998,953.288,456.585,924.01,472.378C894.732,488.172,862.573,488.172,830.414,488.172C798.255,488.172,766.096,488.172,728.415,488.172C690.734,488.172,647.531,488.172,604.328,488.172C561.125,488.172,517.922,488.172,482.766,488.172C447.609,488.172,420.5,488.172,393.391,488.172C366.281,488.172,339.172,488.172,313.604,488.172C288.036,488.172,264.01,488.172,239.984,488.172C215.958,488.172,191.932,488.172,173.705,478.788C155.477,469.404,143.049,450.635,130.988,432.423C118.927,414.211,107.234,396.554,101.388,387.726L95.542,378.898"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_H_8" d="M142.906,348.563L147.073,348.563C151.24,348.563,159.573,348.563,175.753,348.563C191.932,348.563,215.958,348.563,239.984,348.563C264.01,348.563,288.036,348.563,313.604,348.563C339.172,348.563,366.281,348.563,393.391,348.563C420.5,348.563,447.609,348.563,463.289,348.604C478.969,348.646,483.219,348.729,486.802,348.799C490.386,348.87,493.303,348.927,494.761,348.955L496.22,348.984"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_9" d="M709.438,349.063L713.521,348.979C717.604,348.896,725.771,348.729,731.938,348.646C738.104,348.563,742.271,348.563,745.771,348.563C749.271,348.563,752.104,348.563,753.521,348.563L754.938,348.563"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_G_10" d="M901.891,348.563L906.057,348.563C910.224,348.563,918.557,348.563,925.628,348.604C932.698,348.646,938.505,348.729,943.646,348.803C948.787,348.877,953.261,348.941,955.498,348.973L957.735,349.005"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(75.453125, 348.5625)" id="flowchart-A-1976" class="node default"><rect height="54" width="134.90625" y="-27" x="-67.453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-37.453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="74.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MainMenu</p></span></div></foreignObject></g></g><g transform="translate(239.984375, 109.11328125)" id="flowchart-B-1977" class="node default"><polygon transform="translate(-47.078125,47.078125)" class="label-container" points="47.078125,0 94.15625,-47.078125 47.078125,-94.15625 0,-47.078125"></polygon><g transform="translate(-20.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="40.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Jogar</p></span></div></foreignObject></g></g><g transform="translate(393.390625, 109.11328125)" id="flowchart-C-1979" class="node default"><rect height="54" width="112.65625" y="-27" x="-56.328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-26.328125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="52.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Playing</p></span></div></foreignObject></g></g><g transform="translate(604.328125, 90.9765625)" id="flowchart-D-1981" class="node default"><polygon transform="translate(-82.9765625,82.9765625)" class="label-container" points="82.9765625,0 165.953125,-82.9765625 82.9765625,-165.953125 0,-82.9765625"></polygon><g transform="translate(-55.9765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="111.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Cronômetro = 0</p></span></div></foreignObject></g></g><g transform="translate(830.4140625, 90.9765625)" id="flowchart-E-1983" class="node default"><rect height="54" width="138.4375" y="-27" x="-69.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-39.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="78.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>GameOver</p></span></div></foreignObject></g></g><g transform="translate(1042.21875, 109.11328125)" id="flowchart-F-1985" class="node default"><polygon transform="translate(-90.328125,90.328125)" class="label-container" points="90.328125,0 180.65625,-90.328125 90.328125,-180.65625 0,-90.328125"></polygon><g transform="translate(-63.328125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="126.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Jogar Novamente</p></span></div></foreignObject></g></g><g transform="translate(1042.21875, 348.5625)" id="flowchart-G-1989" class="node default"><polygon transform="translate(-80.984375,80.984375)" class="label-container" points="80.984375,0 161.96875,-80.984375 80.984375,-161.96875 0,-80.984375"></polygon><g transform="translate(-53.984375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="107.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Voltar ao Menu</p></span></div></foreignObject></g></g><g transform="translate(604.328125, 348.5625)" id="flowchart-H-1993" class="node default"><polygon transform="translate(-104.609375,104.609375)" class="label-container" points="104.609375,0 209.21875,-104.609375 104.609375,-209.21875 0,-104.609375"></polygon><g transform="translate(-77.609375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="155.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Melhores Pontuações</p></span></div></foreignObject></g></g><g transform="translate(830.4140625, 348.5625)" id="flowchart-I-1995" class="node default"><rect height="54" width="142.953125" y="-27" x="-71.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="82.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HighScores</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="5-persist-ncia-de-dados-sqlite" data-toc="5-persist-ncia-de-dados-sqlite">5. Persist&ecirc;ncia de Dados: SQLite</h3><p id="tmhj7w_347">Um recurso avan&ccedil;ado implementado &eacute; o sistema de pontua&ccedil;&atilde;o persistente usando SQLite. Isso permite que as pontua&ccedil;&otilde;es sejam salvas e carregadas entre as sess&otilde;es do jogo.</p><div class="code-block" data-lang="cpp">
sqlite3 *db; // Ponteiro para o banco de dados SQLite

void openDatabase() { /* ... */ }
void createTable() { /* ... */ }
void saveHighScore(int score) { /* ... */ }
void loadHighScores() { /* ... */ }
</div><p id="tmhj7w_349"><span class="control" id="tmhj7w_351">An&aacute;lise Detalhada da Persist&ecirc;ncia com SQLite:</span></p><ol class="list _decimal" id="tmhj7w_350" type="1"><li class="list__item" id="tmhj7w_352"><p id="tmhj7w_359"><span class="control" id="tmhj7w_360">SQLite como Banco de Dados Embarcado</span>: SQLite &eacute; uma biblioteca de banco de dados SQL leve, sem servidor, que pode ser incorporada diretamente em um aplicativo. &Eacute; ideal para jogos e aplicativos m&oacute;veis que precisam de persist&ecirc;ncia de dados local sem a complexidade de um servidor de banco de dados.</p></li><li class="list__item" id="tmhj7w_353"><p id="tmhj7w_361"><span class="control" id="tmhj7w_362"><code class="code" id="tmhj7w_364">sqlite3 *db</code></span>: Um ponteiro para a estrutura <code class="code" id="tmhj7w_363">sqlite3</code> que representa a conex&atilde;o com o banco de dados.</p></li><li class="list__item" id="tmhj7w_354"><p id="tmhj7w_365"><span class="control" id="tmhj7w_367"><code class="code" id="tmhj7w_368">openDatabase()</code></span>:</p><ul class="list _bullet" id="tmhj7w_366"><li class="list__item" id="tmhj7w_369"><p id="tmhj7w_371">Chama <code class="code" id="tmhj7w_372">sqlite3_open(&quot;bejeweled_scores.db&quot;, &amp;db)</code>. Se o arquivo <code class="code" id="tmhj7w_373">bejeweled_scores.db</code> n&atilde;o existir, ele ser&aacute; criado. Caso contr&aacute;rio, a conex&atilde;o ser&aacute; estabelecida com o banco de dados existente.</p></li><li class="list__item" id="tmhj7w_370"><p id="tmhj7w_374">Inclui tratamento de erros para verificar se a abertura foi bem-sucedida.</p></li></ul></li><li class="list__item" id="tmhj7w_355"><p id="tmhj7w_375"><span class="control" id="tmhj7w_377"><code class="code" id="tmhj7w_378">createTable()</code></span>:</p><ul class="list _bullet" id="tmhj7w_376"><li class="list__item" id="tmhj7w_379"><p id="tmhj7w_382">Executa uma instru&ccedil;&atilde;o SQL <code class="code" id="tmhj7w_383">CREATE TABLE IF NOT EXISTS highscores (...)</code>. O <code class="code" id="tmhj7w_384">IF NOT EXISTS</code> &eacute; crucial para evitar erros se a tabela j&aacute; existir.</p></li><li class="list__item" id="tmhj7w_380"><p id="tmhj7w_385">A tabela <code class="code" id="tmhj7w_386">highscores</code> armazena <code class="code" id="tmhj7w_387">id</code> (chave prim&aacute;ria auto-incrementada), <code class="code" id="tmhj7w_388">score</code> (pontua&ccedil;&atilde;o do jogador) e <code class="code" id="tmhj7w_389">timestamp</code> (data e hora em que a pontua&ccedil;&atilde;o foi registrada).</p></li><li class="list__item" id="tmhj7w_381"><p id="tmhj7w_390">Usa <code class="code" id="tmhj7w_391">sqlite3_exec</code> para executar a instru&ccedil;&atilde;o SQL.</p></li></ul></li><li class="list__item" id="tmhj7w_356"><p id="tmhj7w_392"><span class="control" id="tmhj7w_394"><code class="code" id="tmhj7w_395">saveHighScore(int score)</code></span>:</p><ul class="list _bullet" id="tmhj7w_393"><li class="list__item" id="tmhj7w_396"><p id="tmhj7w_399">Formata uma instru&ccedil;&atilde;o <code class="code" id="tmhj7w_400">INSERT</code> usando <code class="code" id="tmhj7w_401">sprintf</code> para incluir a pontua&ccedil;&atilde;o e um timestamp atual.</p></li><li class="list__item" id="tmhj7w_397"><p id="tmhj7w_402">O timestamp &eacute; gerado usando fun&ccedil;&otilde;es de tempo do C (<code class="code" id="tmhj7w_403">time</code>, <code class="code" id="tmhj7w_404">localtime</code>, <code class="code" id="tmhj7w_405">strftime</code>).</p></li><li class="list__item" id="tmhj7w_398"><p id="tmhj7w_406">Executa a instru&ccedil;&atilde;o <code class="code" id="tmhj7w_407">INSERT</code> via <code class="code" id="tmhj7w_408">sqlite3_exec</code>.</p></li></ul></li><li class="list__item" id="tmhj7w_357"><p id="tmhj7w_409"><span class="control" id="tmhj7w_411"><code class="code" id="tmhj7w_412">loadHighScores()</code></span>:</p><ul class="list _bullet" id="tmhj7w_410"><li class="list__item" id="tmhj7w_413"><p id="tmhj7w_415">Executa uma instru&ccedil;&atilde;o <code class="code" id="tmhj7w_416">SELECT score, timestamp FROM highscores ORDER BY score DESC LIMIT 10;</code> para obter as 10 maiores pontua&ccedil;&otilde;es.</p></li><li class="list__item" id="tmhj7w_414"><p id="tmhj7w_417">Usa um <span class="emphasis" id="tmhj7w_418">callback function</span> (<code class="code" id="tmhj7w_419">static int callback(...)</code>) que &eacute; invocada para cada linha de resultado. Dentro do callback, os dados s&atilde;o lidos e armazenados em uma estrutura de dados (ex: <code class="code" id="tmhj7w_420">std::vector&lt;std::pair&lt;int, std::string&gt;&gt; highScores</code>).</p></li></ul></li><li class="list__item" id="tmhj7w_358"><p id="tmhj7w_421"><span class="control" id="tmhj7w_422">Fechamento da Conex&atilde;o</span>: &Eacute; fundamental chamar <code class="code" id="tmhj7w_423">sqlite3_close(db)</code> ao final do programa para liberar os recursos do banco de dados.</p></li></ol></section></section><section class="chapter"><h2 id="estrutura-do-c-digo-main-cpp" data-toc="estrutura-do-c-digo-main-cpp">Estrutura do C&oacute;digo (<code class="code" id="tmhj7w_427">main.cpp</code>)</h2><p id="tmhj7w_425">O arquivo <code class="code" id="tmhj7w_428">main.cpp</code> do Bejeweled segue uma estrutura comum para jogos SFML, organizada para clareza e modularidade.</p><ol class="list _decimal" id="tmhj7w_426" type="1"><li class="list__item" id="tmhj7w_429"><p id="tmhj7w_433"><span class="control" id="tmhj7w_435">Includes</span>:</p><ul class="list _bullet" id="tmhj7w_434"><li class="list__item" id="tmhj7w_436"><p id="tmhj7w_440"><code class="code" id="tmhj7w_441">SFML/Graphics.hpp</code>: Para todas as funcionalidades gr&aacute;ficas (janela, texturas, sprites, texto).</p></li><li class="list__item" id="tmhj7w_437"><p id="tmhj7w_442"><code class="code" id="tmhj7w_443">time.h</code>: Para fun&ccedil;&otilde;es de tempo (gera&ccedil;&atilde;o de n&uacute;meros aleat&oacute;rios, timestamps).</p></li><li class="list__item" id="tmhj7w_438"><p id="tmhj7w_444"><code class="code" id="tmhj7w_445">vector</code>, <code class="code" id="tmhj7w_446">iostream</code>, <code class="code" id="tmhj7w_447">string</code>, <code class="code" id="tmhj7w_448">iomanip</code>: Utilit&aacute;rios C++ padr&atilde;o.</p></li><li class="list__item" id="tmhj7w_439"><p id="tmhj7w_449"><code class="code" id="tmhj7w_450">sqlite3.h</code>: Para a integra&ccedil;&atilde;o com o banco de dados SQLite.</p></li></ul></li><li class="list__item" id="tmhj7w_430"><p id="tmhj7w_451"><span class="control" id="tmhj7w_453">Constantes e Estruturas Globais</span>:</p><ul class="list _bullet" id="tmhj7w_452"><li class="list__item" id="tmhj7w_454"><p id="tmhj7w_460"><code class="code" id="tmhj7w_461">ts</code>: Tamanho do tile (gema) em pixels.</p></li><li class="list__item" id="tmhj7w_455"><p id="tmhj7w_462"><code class="code" id="tmhj7w_463">offset</code>: Um <code class="code" id="tmhj7w_464">Vector2i</code> para ajustar a posi&ccedil;&atilde;o de desenho da grade na tela, centralizando-a ou posicionando-a conforme o design da UI.</p></li><li class="list__item" id="tmhj7w_456"><p id="tmhj7w_465"><code class="code" id="tmhj7w_466">struct piece</code>: A estrutura que define as propriedades de cada gema.</p></li><li class="list__item" id="tmhj7w_457"><p id="tmhj7w_467"><code class="code" id="tmhj7w_468">grid[10][10]</code>: A matriz global que representa o tabuleiro de jogo.</p></li><li class="list__item" id="tmhj7w_458"><p id="tmhj7w_469"><code class="code" id="tmhj7w_470">enum GameState</code>: Define os estados poss&iacute;veis do jogo.</p></li><li class="list__item" id="tmhj7w_459"><p id="tmhj7w_471"><code class="code" id="tmhj7w_472">sqlite3 *db</code>: O ponteiro global para a conex&atilde;o com o banco de dados.</p></li></ul></li><li class="list__item" id="tmhj7w_431"><p id="tmhj7w_473"><span class="control" id="tmhj7w_475">Fun&ccedil;&otilde;es Auxiliares</span>:</p><ul class="list _bullet" id="tmhj7w_474"><li class="list__item" id="tmhj7w_476"><p id="tmhj7w_479"><code class="code" id="tmhj7w_480">swap(piece p1, piece p2)</code>: L&oacute;gica para trocar duas gemas.</p></li><li class="list__item" id="tmhj7w_477"><p id="tmhj7w_481"><code class="code" id="tmhj7w_482">resetGame()</code>: Inicializa o tabuleiro com gemas aleat&oacute;rias e reinicia o cron&ocirc;metro.</p></li><li class="list__item" id="tmhj7w_478"><p id="tmhj7w_483">Fun&ccedil;&otilde;es SQLite (<code class="code" id="tmhj7w_484">openDatabase</code>, <code class="code" id="tmhj7w_485">createTable</code>, <code class="code" id="tmhj7w_486">saveHighScore</code>, <code class="code" id="tmhj7w_487">loadHighScores</code>): Gerenciam a intera&ccedil;&atilde;o com o banco de dados.</p></li></ul></li><li class="list__item" id="tmhj7w_432"><p id="tmhj7w_488"><span class="control" id="tmhj7w_490">Fun&ccedil;&atilde;o <code class="code" id="tmhj7w_491">main()</code></span>: O ponto de entrada do programa.</p><ul class="list _bullet" id="tmhj7w_489"><li class="list__item" id="tmhj7w_492"><p id="tmhj7w_495"><span class="control" id="tmhj7w_497">Inicializa&ccedil;&atilde;o</span>:</p><ul class="list _bullet" id="tmhj7w_496"><li class="list__item" id="tmhj7w_498"><p id="tmhj7w_505"><code class="code" id="tmhj7w_506">srand(time(0))</code>: Inicializa o gerador de n&uacute;meros aleat&oacute;rios.</p></li><li class="list__item" id="tmhj7w_499"><p id="tmhj7w_507"><code class="code" id="tmhj7w_508">RenderWindow app(...)</code>: Cria a janela do jogo.</p></li><li class="list__item" id="tmhj7w_500"><p id="tmhj7w_509"><code class="code" id="tmhj7w_510">app.setFramerateLimit(60)</code>: Limita o FPS para garantir consist&ecirc;ncia.</p></li><li class="list__item" id="tmhj7w_501"><p id="tmhj7w_511">Carregamento de <code class="code" id="tmhj7w_512">Texture</code> (fundo, gemas), cria&ccedil;&atilde;o de <code class="code" id="tmhj7w_513">Sprite</code>.</p></li><li class="list__item" id="tmhj7w_502"><p id="tmhj7w_514">Carregamento de <code class="code" id="tmhj7w_515">Font</code> e cria&ccedil;&atilde;o de objetos <code class="code" id="tmhj7w_516">Text</code> para todos os elementos da UI (t&iacute;tulos, bot&otilde;es, pontua&ccedil;&atilde;o, tempo, mensagens de game over, high scores).</p></li><li class="list__item" id="tmhj7w_503"><p id="tmhj7w_517"><code class="code" id="tmhj7w_518">openDatabase()</code> e <code class="code" id="tmhj7w_519">createTable()</code>: Inicializam o sistema de persist&ecirc;ncia.</p></li><li class="list__item" id="tmhj7w_504"><p id="tmhj7w_520"><code class="code" id="tmhj7w_521">resetGame()</code>: Prepara o tabuleiro inicial.</p></li></ul></li><li class="list__item" id="tmhj7w_493"><p id="tmhj7w_522"><span class="control" id="tmhj7w_524">Loop Principal do Jogo (<code class="code" id="tmhj7w_525">while (app.isOpen())</code>)</span>: Este &eacute; o cora&ccedil;&atilde;o do jogo, executando continuamente enquanto a janela est&aacute; aberta.</p><ul class="list _bullet" id="tmhj7w_523"><li class="list__item" id="tmhj7w_526"><p id="tmhj7w_530"><span class="control" id="tmhj7w_531">Controle de Tempo (<code class="code" id="tmhj7w_532">deltaTime</code>)</span>: Calcula o tempo decorrido entre os frames para garantir que as anima&ccedil;&otilde;es e o cron&ocirc;metro sejam independentes da taxa de quadros.</p></li><li class="list__item" id="tmhj7w_527"><p id="tmhj7w_533"><span class="control" id="tmhj7w_534">Processamento de Eventos (<code class="code" id="tmhj7w_536">while (app.pollEvent(e))</code>)</span>: Captura e responde a eventos do usu&aacute;rio (cliques do mouse, fechamento da janela). A l&oacute;gica de resposta varia de acordo com o <code class="code" id="tmhj7w_535">gameState</code> atual.</p></li><li class="list__item" id="tmhj7w_528"><p id="tmhj7w_537"><span class="control" id="tmhj7w_538">Atualiza&ccedil;&atilde;o da L&oacute;gica do Jogo (<code class="code" id="tmhj7w_540">if (gameState == Playing)</code>)</span>: Toda a l&oacute;gica de jogo (movimento de gemas, detec&ccedil;&atilde;o de matches, anima&ccedil;&otilde;es, atualiza&ccedil;&atilde;o do cron&ocirc;metro) &eacute; executada apenas quando o jogo est&aacute; no estado <code class="code" id="tmhj7w_539">Playing</code>.</p></li><li class="list__item" id="tmhj7w_529"><p id="tmhj7w_541"><span class="control" id="tmhj7w_542">Renderiza&ccedil;&atilde;o (<code class="code" id="tmhj7w_544">app.draw(...)</code>)</span>: Limpa a tela e desenha todos os elementos visuais. A interface desenhada tamb&eacute;m depende do <code class="code" id="tmhj7w_543">gameState</code> atual.</p></li></ul></li><li class="list__item" id="tmhj7w_494"><p id="tmhj7w_545"><span class="control" id="tmhj7w_546">Fechamento</span>: <code class="code" id="tmhj7w_547">sqlite3_close(db)</code>: Garante que a conex&atilde;o com o banco de dados seja encerrada corretamente.</p></li></ul></li></ol></section><section class="chapter"><h2 id="conceitos-de-programa-o-aprendidos" data-toc="conceitos-de-programa-o-aprendidos">Conceitos de Programa&ccedil;&atilde;o Aprendidos</h2><p id="tmhj7w_548">Ao estudar e modificar o c&oacute;digo do Bejeweled, voc&ecirc; aprender&aacute; uma vasta gama de conceitos essenciais em desenvolvimento de jogos e programa&ccedil;&atilde;o geral:</p><ol class="list _decimal" id="tmhj7w_549" type="1"><li class="list__item" id="tmhj7w_551"><p id="tmhj7w_560"><span class="control" id="tmhj7w_561">Programa&ccedil;&atilde;o Orientada a Eventos</span>: Compreender como o jogo reage de forma ass&iacute;ncrona &agrave;s intera&ccedil;&otilde;es do usu&aacute;rio (cliques do mouse, pressionamento de teclas). O loop de eventos (<code class="code" id="tmhj7w_562">app.pollEvent</code>) &eacute; o cerne dessa abordagem.</p></li><li class="list__item" id="tmhj7w_552"><p id="tmhj7w_563"><span class="control" id="tmhj7w_564">Gerenciamento de Estados (M&aacute;quina de Estados Finitos - FSM)</span>: A utiliza&ccedil;&atilde;o do <code class="code" id="tmhj7w_565">enum GameState</code> demonstra um padr&atilde;o de design fundamental para organizar o fluxo do jogo. Voc&ecirc; aprender&aacute; a controlar as transi&ccedil;&otilde;es entre diferentes telas (menu, jogo, game over) e a executar l&oacute;gicas espec&iacute;ficas para cada estado, tornando o c&oacute;digo mais modular e f&aacute;cil de depurar.</p></li><li class="list__item" id="tmhj7w_553"><p id="tmhj7w_566"><span class="control" id="tmhj7w_567">Manipula&ccedil;&atilde;o de Matrizes 2D</span>: O tabuleiro de jogo &eacute; uma matriz 2D (<code class="code" id="tmhj7w_568">grid[10][10]</code>). Voc&ecirc; aprender&aacute; a acessar, modificar e iterar sobre elementos em uma estrutura bidimensional, essencial para jogos baseados em grade. A t&eacute;cnica de &quot;bordas sentinela&quot; (usando uma matriz 10x10 para um tabuleiro 8x8) &eacute; um exemplo pr&aacute;tico de como simplificar a l&oacute;gica de limites.</p></li><li class="list__item" id="tmhj7w_554"><p id="tmhj7w_569"><span class="control" id="tmhj7w_570">Algoritmos de Busca e Varredura</span>: A detec&ccedil;&atilde;o de combina&ccedil;&otilde;es (<code class="code" id="tmhj7w_571">Match Finding</code>) envolve varrer a matriz em busca de padr&otilde;es. Voc&ecirc; entender&aacute; como implementar algoritmos eficientes para identificar grupos de gemas id&ecirc;nticas na horizontal e na vertical.</p></li><li class="list__item" id="tmhj7w_555"><p id="tmhj7w_572"><span class="control" id="tmhj7w_573">Anima&ccedil;&atilde;o e Interpola&ccedil;&atilde;o</span>: O controle de <code class="code" id="tmhj7w_574">alpha</code> para o desaparecimento e a atualiza&ccedil;&atilde;o gradual das coordenadas <code class="code" id="tmhj7w_575">x</code> e <code class="code" id="tmhj7w_576">y</code> para a queda de gemas s&atilde;o exemplos de t&eacute;cnicas de anima&ccedil;&atilde;o. Voc&ecirc; aprender&aacute; a criar movimentos e transi&ccedil;&otilde;es visuais suaves, essenciais para uma boa experi&ecirc;ncia de usu&aacute;rio.</p></li><li class="list__item" id="tmhj7w_556"><p id="tmhj7w_577"><span class="control" id="tmhj7w_578">Persist&ecirc;ncia de Dados com SQLite</span>: A integra&ccedil;&atilde;o com SQLite &eacute; uma introdu&ccedil;&atilde;o pr&aacute;tica a bancos de dados embarcados. Voc&ecirc; aprender&aacute; a abrir/criar um banco de dados, definir esquemas de tabela, inserir dados (pontua&ccedil;&otilde;es) e consultar informa&ccedil;&otilde;es (melhores pontua&ccedil;&otilde;es), permitindo que o jogo salve o progresso entre as sess&otilde;es.</p></li><li class="list__item" id="tmhj7w_557"><p id="tmhj7w_579"><span class="control" id="tmhj7w_580">Timing e Controle de Jogo</span>: O uso de <code class="code" id="tmhj7w_581">sf::Clock</code> e <code class="code" id="tmhj7w_582">deltaTime</code> &eacute; crucial para garantir que a velocidade do jogo e das anima&ccedil;&otilde;es seja consistente, independentemente da taxa de quadros do computador. Voc&ecirc; aprender&aacute; a gerenciar cron&ocirc;metros e a sincronizar eventos baseados no tempo.</p></li><li class="list__item" id="tmhj7w_558"><p id="tmhj7w_583"><span class="control" id="tmhj7w_584">Design de UI/UX B&aacute;sico</span>: A cria&ccedil;&atilde;o de menus interativos, bot&otilde;es e a exibi&ccedil;&atilde;o de informa&ccedil;&otilde;es como pontua&ccedil;&atilde;o e tempo s&atilde;o elementos fundamentais de UI (User Interface) e UX (User Experience). Voc&ecirc; ver&aacute; como organizar e renderizar esses elementos para fornecer feedback claro ao jogador.</p></li><li class="list__item" id="tmhj7w_559"><p id="tmhj7w_585"><span class="control" id="tmhj7w_586">Gera&ccedil;&atilde;o de Conte&uacute;do Procedural</span>: A gera&ccedil;&atilde;o aleat&oacute;ria de gemas no in&iacute;cio do jogo e durante o preenchimento da grade &eacute; um exemplo simples de gera&ccedil;&atilde;o procedural, onde o conte&uacute;do do jogo &eacute; criado algoritmicamente em tempo de execu&ccedil;&atilde;o.</p></li></ol><p id="tmhj7w_550">Bejeweled &eacute; um excelente projeto para aprofundar seus conhecimentos em desenvolvimento de jogos, combinando l&oacute;gica de quebra-cabe&ccedil;a com elementos visuais e persist&ecirc;ncia de dados.</p></section><div class="last-modified">28 August 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="xonix.html" class="navigation-links__prev">Xonix</a><a href="troubleshooting-setup.html" class="navigation-links__next">Troubleshooting</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>